(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{bj:()=>U,O9:()=>x,Fg:()=>_,wK:()=>m,$q:()=>b,Hf:()=>f,jS:()=>j,wk:()=>g,ED:()=>S,rC:()=>h,o:()=>D});var t=function(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)},r=function(e,t,r){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass),n.textContent=""},n=function(e,r,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?function(e,t){e.disabled=!1,e.classList.remove(t.inactiveButtonClass)}(r,n):t(r,n)};function o(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&i(e.target.closest(".popup"))}function a(e){"Escape"===e.key&&i(document.querySelector(".popup_opened"))}function c(e){e.classList.add("popup_opened"),e.addEventListener("click",o),document.addEventListener("keydown",a)}function i(e){e.removeEventListener("click",o),e.classList.remove("popup_opened"),document.removeEventListener("keydown",a)}var s={baseUrl:"https://nomoreparties.co/v1/plus-cohort-26",headers:{"content-type":"application/json",authorization:"2e13d1ed-4c1c-4aa9-8a4c-82d13ffda241"}};function u(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}function l(e,t){var r=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),n=r.querySelector(".card__image"),o=r.querySelector(".card__like-counter"),a=r.querySelector(".card__delete");return r.dataset.id=e._id,e.owner._id===t&&(a.classList.add("card__delete_enabled"),a.addEventListener("click",(function(t){var r;(r=e,fetch("".concat(s.baseUrl,"/cards/").concat(r._id),{method:"DELETE",headers:s.headers}).then(u)).then(t.target.closest(".card").remove())}))),n.src=e.link,r.querySelector(".card__title").textContent=e.name,n.alt="Фотография "+e.name,o.textContent=e.likes.length,e.likes.some((function(e){return e._id===t}))&&r.querySelector(".card__like").classList.add("card__like_liked"),r.querySelector(".card__like").addEventListener("click",(function(r){var n;e.likes.some((function(e){return e._id===t}))?(n=e,fetch("".concat(s.baseUrl,"/cards/likes/").concat(n._id),{method:"DELETE",headers:s.headers}).then(u)).then((function(t){o.textContent=t.likes.length,e.likes=t.likes,r.target.classList.toggle("card__like_liked")})):function(e){return fetch("".concat(s.baseUrl,"/cards/likes/").concat(e._id),{method:"PUT",headers:s.headers}).then(u)}(e).then((function(t){o.textContent=t.likes.length,e.likes=t.likes,r.target.classList.toggle("card__like_liked")}))})),n.addEventListener("click",(function(){var t;t=e,_.src=t.link,m.textContent=t.name,_.alt="Фотография "+t.name,c(f)})),r}var d,p,f=document.querySelector(".popup_type_image"),_=f.querySelector(".popup__image"),m=f.querySelector(".popup__image-title"),v=(f.querySelector(".popup__close-button"),document.querySelector(".profile")),y=v.querySelector(".profile__edit-button"),h=v.querySelector(".profile__name"),S=v.querySelector(".profile__status"),k=v.querySelector(".profile__avatar"),q=v.querySelector(".profile__add-button"),b=document.querySelector(".popup_type_avatar"),L=document.forms["avatar-form"],E=L.querySelector('input[name="avatarlink"]'),g=document.querySelector(".popup_type_profile"),C=(g.querySelector(".popup__close-button"),document.forms["profile-form"]),x=C.querySelector('input[name="profilename"]'),U=C.querySelector('input[name="profilejob"]'),j=document.querySelector(".popup_type_mesto"),O=(j.querySelector(".popup__close-button"),document.forms["card-form"]),P=O.querySelector('input[name="cardname"]'),w=O.querySelector('input[name="cardlink"]'),A=document.querySelector(".cards"),D={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};fetch("".concat(s.baseUrl,"/users/me"),{headers:s.headers}).then(u).then((function(e){return h.textContent=e.name,S.textContent=e.about,k.src=e.avatar,d=e._id})).then((function(e){fetch("".concat(s.baseUrl,"/cards"),{headers:s.headers}).then(u).then((function(t){t.forEach((function(t){A.append(l(t,e))}))}))})),y.addEventListener("click",(function(){x.value=h.textContent,U.value=S.textContent,r(g.querySelector(".popup__form"),x,D),r(g.querySelector(".popup__form"),U,D),c(g)})),q.addEventListener("click",(function(){c(j)})),C.addEventListener("submit",(function(e){var t;e.preventDefault(),(t={name:x.value,about:U.value},fetch("".concat(s.baseUrl,"/users/me"),{method:"PATCH",headers:s.headers,body:JSON.stringify(t)}).then(u)).then((function(t){h.textContent=t.name,S.textContent=t.about,i(g),e.target.reset()}))})),O.addEventListener("submit",(function(e){var t;e.preventDefault(),(t={name:P.value,link:w.value},fetch("".concat(s.baseUrl,"/cards"),{method:"POST",headers:s.headers,body:JSON.stringify(t)}).then(u)).then((function(t){A.prepend(l(t,d)),i(j),e.target.reset()}))})),k.addEventListener("click",(function(){c(b)})),L.addEventListener("submit",(function(e){var t;e.preventDefault(),(t={avatar:E.value},fetch("".concat(s.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:s.headers,body:JSON.stringify(t)}).then(u)).then((function(t){console.log(t),k.src=t.avatar,i(b),e.target.reset()}))})),p=D,Array.from(document.querySelectorAll(p.formSelector)).forEach((function(e){!function(e,o){var a=Array.from(e.querySelectorAll(o.inputSelector)),c=e.querySelector(o.submitButtonSelector);n(a,c,o),e.addEventListener("reset",(function(){t(c,o)})),a.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?r(e,t,n):function(e,t,r,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n.inputErrorClass),o.textContent=r,o.classList.add(n.errorClass)}(e,t,t.validationMessage,n)}(e,t,o),n(a,c,o)}))}))}(e,p)}))})();