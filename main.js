(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{bj:()=>P,O9:()=>O,Fg:()=>v,wK:()=>y,$q:()=>L,Hf:()=>_,jS:()=>w,wk:()=>U,ED:()=>q,rC:()=>b,o:()=>N});var t=function(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""},r=function(e,n,r){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?function(e,t){e.disabled=!1,e.classList.remove(t.inactiveButtonClass)}(n,r):t(n,r)};function o(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&i(e.target.closest(".popup"))}function a(e){"Escape"===e.key&&i(document.querySelector(".popup_opened"))}function c(e){e.classList.add("popup_opened"),e.addEventListener("click",o),document.addEventListener("keydown",a)}function i(e){e.removeEventListener("click",o),e.classList.remove("popup_opened"),document.removeEventListener("keydown",a)}function u(e){var t=e.formElement,n=e.text,r=e.disabled,o=t.querySelector(".popup__save-button");o.disabled=!!r&&"disabled",o.textContent=n}var s={baseUrl:"https://nomoreparties.co/v1/plus-cohort-26",headers:{"content-type":"application/json",authorization:"2e13d1ed-4c1c-4aa9-8a4c-82d13ffda241"}};function l(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}function d(e,t,n,r){r.textContent=e.likes.length,t.likes=e.likes,n.classList.toggle("card__like_liked")}function p(e,t){var n=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),r=n.querySelector(".card__image"),o=n.querySelector(".card__like-counter"),a=n.querySelector(".card__delete"),i=n.querySelector(".card__like");return n.dataset.id=e._id,r.src=e.link,n.querySelector(".card__title").textContent=e.name,r.alt="Фотография "+e.name,o.textContent=e.likes.length,function(e,t,n,r){e.owner._id===t&&(n.classList.add("card__delete_enabled"),n.addEventListener("click",(function(){return function(e,t){var n;(n=e,fetch("".concat(s.baseUrl,"/cards/").concat(n._id),{method:"DELETE",headers:s.headers}).then(l)).then(t.remove())}(e,r)})))}(e,t,a,n),function(e,t,n){e.likes.some((function(e){return e._id===n}))&&t.classList.add("card__like_liked")}(e,i,t),i.addEventListener("click",(function(){return function(e,t,n,r){var o;e.likes.some((function(e){return e._id===t}))?(o=e,fetch("".concat(s.baseUrl,"/cards/likes/").concat(o._id),{method:"DELETE",headers:s.headers}).then(l)).then((function(t){return d(t,e,r,n)})):function(e){return fetch("".concat(s.baseUrl,"/cards/likes/").concat(e._id),{method:"PUT",headers:s.headers}).then(l)}(e).then((function(t){return d(t,e,r,n)}))}(e,t,o,i)})),r.addEventListener("click",(function(){var t;t=e,v.src=t.link,y.textContent=t.name,v.alt="Фотография "+t.name,c(_)})),n}var f,m,_=document.querySelector(".popup_type_image"),v=_.querySelector(".popup__image"),y=_.querySelector(".popup__image-title"),h=(_.querySelector(".popup__close-button"),document.querySelector(".profile")),S=h.querySelector(".profile__edit-button"),b=h.querySelector(".profile__name"),q=h.querySelector(".profile__status"),E=h.querySelector(".profile__avatar"),k=h.querySelector(".profile__avatar-container"),g=h.querySelector(".profile__add-button"),L=document.querySelector(".popup_type_avatar"),C=document.forms["avatar-form"],x=C.querySelector('input[name="avatarlink"]'),U=document.querySelector(".popup_type_profile"),j=(U.querySelector(".popup__close-button"),document.forms["profile-form"]),O=j.querySelector('input[name="profilename"]'),P=j.querySelector('input[name="profilejob"]'),w=document.querySelector(".popup_type_mesto"),A=(w.querySelector(".popup__close-button"),document.forms["card-form"]),D=A.querySelector('input[name="cardname"]'),T=A.querySelector('input[name="cardlink"]'),B=document.querySelector(".cards"),N={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};fetch("".concat(s.baseUrl,"/users/me"),{headers:s.headers}).then(l).then((function(e){return b.textContent=e.name,q.textContent=e.about,E.src=e.avatar,f=e._id})).then((function(e){fetch("".concat(s.baseUrl,"/cards"),{headers:s.headers}).then(l).then((function(t){t.forEach((function(t){B.append(p(t,e))}))}))})).catch((function(e){return console.log(e)})),S.addEventListener("click",(function(){O.value=b.textContent,P.value=q.textContent,n(U.querySelector(".popup__form"),O,N),n(U.querySelector(".popup__form"),P,N),c(U)})),g.addEventListener("click",(function(){c(w)})),j.addEventListener("submit",(function(e){var t;e.preventDefault(),u({formElement:e.target,text:"Сохранение...",disabled:!0}),(t={name:O.value,about:P.value},fetch("".concat(s.baseUrl,"/users/me"),{method:"PATCH",headers:s.headers,body:JSON.stringify(t)}).then(l)).then((function(t){b.textContent=t.name,q.textContent=t.about,i(U),e.target.reset()})).catch((function(e){return console.log(e)})).finally((function(){u({formElement:e.target,text:"Сохранить",disabled:!1})}))})),A.addEventListener("submit",(function(e){var t;e.preventDefault(),u({formElement:e.target,text:"Сохранение...",disabled:!0}),(t={name:D.value,link:T.value},fetch("".concat(s.baseUrl,"/cards"),{method:"POST",headers:s.headers,body:JSON.stringify(t)}).then(l)).then((function(t){B.prepend(p(t,f)),i(w),e.target.reset()})).catch((function(e){return console.log(e)})).finally((function(){u({formElement:e.target,text:"Создать",disabled:!1})}))})),k.addEventListener("click",(function(){c(L)})),C.addEventListener("submit",(function(e){var t;e.preventDefault(),u({formElement:e.target,text:"Сохранение...",disabled:!0}),(t={avatar:x.value},fetch("".concat(s.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:s.headers,body:JSON.stringify(t)}).then(l)).then((function(t){E.src=t.avatar,i(L),e.target.reset()})).catch((function(e){return console.log(e)})).finally((function(){u({formElement:e.target,text:"Сохранить",disabled:!1})}))})),m=N,Array.from(document.querySelectorAll(m.formSelector)).forEach((function(e){!function(e,o){var a=Array.from(e.querySelectorAll(o.inputSelector)),c=e.querySelector(o.submitButtonSelector);r(a,c,o),e.addEventListener("reset",(function(){t(c,o)})),a.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,r){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?n(e,t,r):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,r)}(e,t,o),r(a,c,o)}))}))}(e,m)}))})();